<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · AWSBatch.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/invenia.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="AWSBatch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">AWSBatch.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="AWSBatch"><a class="docs-heading-anchor" href="#AWSBatch">AWSBatch</a><a id="AWSBatch-1"></a><a class="docs-heading-anchor-permalink" href="#AWSBatch" title="Permalink"></a></h1><p><a href="https://juliacloud.github.io/AWSBatch.jl/stable"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Docs: stable"/></a> <a href="https://github.com/JuliaCloud/AWSBatch.jl/actions/workflows/CI.yml"><img src="https://github.com/JuliaCloud/AWSBatch.jl/actions/workflows/CI.yml/badge.svg" alt="CI"/></a></p><p>AWSBatch.jl provides a small set of methods for working with AWS Batch jobs from julia.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>AWSBatch assumes that you already have an AWS account configured with:</p><ol><li>An <a href="https://aws.amazon.com/ecr/">ECR repository</a> and a docker image pushed to it <a href="http://docs.aws.amazon.com/AmazonECR/latest/userguide/docker-push-ecr-image.html">[1]</a>.</li><li>An <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM role</a> to apply to the batch jobs.</li><li>A compute environment and job queue for submitting jobs to <a href="http://docs.aws.amazon.com/batch/latest/userguide/Batch_GetStarted.html#first-run-step-2">[2]</a>.</li></ol><p>Please review the <a href="http://docs.aws.amazon.com/batch/latest/userguide/Batch_GetStarted.html">&quot;Getting Started with AWS Batch&quot;</a> guide and example <a href="https://s3-us-west-2.amazonaws.com/cloudformation-templates-us-west-2/Managed_EC2_Batch_Environment.template">CloudFormation template</a> for more details.</p><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><pre><code class="language-julia">julia&gt; using AWSBatch

julia&gt; job = run_batch(
           name=&quot;Demo&quot;,
           definition=&quot;AWSBatchJobDefinition&quot;,
           queue=&quot;AWSBatchJobQueue&quot;,
           image = &quot;000000000000.dkr.ecr.us-east-1.amazonaws.com/demo:latest&quot;,
           role = &quot;arn:aws:iam::000000000000:role/AWSBatchJobRole&quot;,
           vcpus = 1,
           memory = 1024,
           cmd = `julia -e &#39;println(&quot;Hello World!&quot;)&#39;`,
       )
AWSBatch.BatchJob(&quot;00000000-0000-0000-0000-000000000000&quot;)

julia&gt; wait(job, [AWSBatch.SUCCEEDED])
true

julia&gt; results = log_events(job)
1-element Array{AWSBatch.LogEvent,1}:
 AWSBatch.LogEvent(&quot;00000000000000000000000000000000000000000000000000000000&quot;, 2018-04-23T19:41:18.765, 2018-04-23T19:41:18.677, &quot;Hello World!&quot;)</code></pre><p>AWSBatch also supports Memento logging for more detailed usage information.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.run_batch-Tuple{}" href="#AWSBatch.run_batch-Tuple{}"><code>AWSBatch.run_batch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">run_batch(;
    name::AbstractString=&quot;&quot;,
    queue::AbstractString=&quot;&quot;,
    region::AbstractString=&quot;&quot;,
    definition::Union{AbstractString, JobDefinition, Nothing}=nothing,
    image::AbstractString=&quot;&quot;,
    vcpus::Integer=1,
    memory::Integer=-1,
    role::AbstractString=&quot;&quot;,
    cmd::Cmd=``,
    num_jobs::Integer=1,
    parameters::Dict{String, String}=Dict{String, String}(),
) -&gt; BatchJob</code></pre><p>Handles submitting a BatchJob based on various potential defaults. For example, default job fields can be inferred from an existing job definition or an existing job (if currently running in a batch job).</p><p>Order of priority from highest to lowest:</p><ol><li>Explict arguments passed in via <code>kwargs</code>.</li><li>Inferred environment (e.g., <code>AWS_BATCH_JOB_ID</code> environment variable set)</li><li>Job definition parameters</li></ol><p>If no valid job definition exists (see <a href="#AWSBatch.job_definition_arn-Tuple{AbstractString}"><code>AWSBatch.job_definition_arn</code></a> then a new job definition will be created and registered based on the job parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/AWSBatch.jl#LL34-L61">source</a></section></article><h3 id="BatchJob"><a class="docs-heading-anchor" href="#BatchJob">BatchJob</a><a id="BatchJob-1"></a><a class="docs-heading-anchor-permalink" href="#BatchJob" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.BatchJob" href="#AWSBatch.BatchJob"><code>AWSBatch.BatchJob</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">BatchJob</code></pre><p>Stores a batch job id in order to:</p><ul><li><code>describe</code> a job and its parameters</li><li>check on the <code>status</code> of a job</li><li><code>wait</code> for a job to complete</li><li>fetch <code>log_events</code></li></ul><p><strong>Fields</strong></p><ul><li><code>id::AbstractString</code>: jobId</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/base/#L0-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.submit-Tuple{AbstractString,JobDefinition,AbstractString}" href="#AWSBatch.submit-Tuple{AbstractString,JobDefinition,AbstractString}"><code>AWSBatch.submit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">submit(
    name::AbstractString,
    definition::JobDefinition,
    queue::AbstractString;
    container::AbstractDict=Dict(),
    parameters::Dict{String,String}=Dict{String, String}(),
    region::AbstractString=&quot;&quot;,
    num_jobs::Integer=1,
) -&gt; BatchJob</code></pre><p>Handles submitting the batch job. Returns a <code>BatchJob</code> wrapper for the id.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL22-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.describe-Tuple{BatchJob}" href="#AWSBatch.describe-Tuple{BatchJob}"><code>AWSBatch.describe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">describe(job::BatchJob) -&gt; Dict</code></pre><p>Provides details about the AWS batch job.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.JobDefinition-Tuple{BatchJob}" href="#AWSBatch.JobDefinition-Tuple{BatchJob}"><code>AWSBatch.JobDefinition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">JobDefinition</code></pre><p>Returns the job definition corresponding to a batch job.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.status-Tuple{BatchJob}" href="#AWSBatch.status-Tuple{BatchJob}"><code>AWSBatch.status</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">status(job::BatchJob) -&gt; JobState</code></pre><p>Returns the current status of a job.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL95-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.wait-Tuple{Function,BatchJob}" href="#Base.wait-Tuple{Function,BatchJob}"><code>Base.wait</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">wait(
    cond::Function,
    job::BatchJob;
    timeout=600,
    delay=5
)</code></pre><p>Polls the batch job state until it hits one of the conditions in <code>cond</code>. The loop will exit if it hits a <code>failure</code> condition and will not catch any excpetions. The polling interval can be controlled with <code>delay</code> and <code>timeout</code> provides a maximum polling time.</p><p><strong>Examples</strong></p><pre><code class="language-julia">julia&gt; wait(state -&gt; state &lt; SUCCEEDED, job)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL116-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.wait-Tuple{BatchJob,Array{JobState,1},Array{JobState,1}}" href="#Base.wait-Tuple{BatchJob,Array{JobState,1},Array{JobState,1}}"><code>Base.wait</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">wait(
    job::BatchJob,
    cond::Vector{JobState}=[RUNNING, SUCCEEDED],
    failure::Vector{JobState}=[FAILED];
    kwargs...,
)</code></pre><p>Polls the batch job state until it hits one of the conditions in <code>cond</code>. The loop will exit if it hits a <code>failure</code> condition and will not catch any excpetions. The polling interval can be controlled with <code>delay</code> and <code>timeout</code> provides a maximum polling time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL177-L189">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.log_events-Tuple{BatchJob}" href="#AWSBatch.log_events-Tuple{BatchJob}"><code>AWSBatch.log_events</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">log_events(job::BatchJob) -&gt; Union{Vector{LogEvent}, Nothing}</code></pre><p>Fetches the logStreamName, fetches the CloudWatch logs, and returns a vector of log events. If the log stream does not currently exist then <code>nothing</code> is returned.</p><p>NOTES:</p><ul><li>The <code>logStreamName</code> isn&#39;t available until the job is RUNNING, so you may want to use <code>wait(job)</code> or <code>wait(job, [AWSBatch.SUCCEEDED])</code> prior to calling this function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/batch_job.jl#LL209-L218">source</a></section></article><h3 id="JobDefinition"><a class="docs-heading-anchor" href="#JobDefinition">JobDefinition</a><a id="JobDefinition-1"></a><a class="docs-heading-anchor-permalink" href="#JobDefinition" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.JobDefinition" href="#AWSBatch.JobDefinition"><code>AWSBatch.JobDefinition</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">JobDefinition</code></pre><p>Stores the job definition arn including the revision.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/base/#L0-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.job_definition_arn-Tuple{AbstractString}" href="#AWSBatch.job_definition_arn-Tuple{AbstractString}"><code>AWSBatch.job_definition_arn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">job_definition_arn(
    definition_name::AbstractString;
    image::AbstractString=&quot;&quot;,
    role::AbstractString=&quot;&quot;
) -&gt; Union{AbstractString, Nothing}</code></pre><p>Looks up the ARN (Amazon Resource Name) for the latest job definition that can be reused. Returns a JobDefinition with the ARN that can be reused or <code>nothing</code>.</p><p>A job definition can only be reused if:</p><ol><li>status = ACTIVE</li><li>type = container</li><li>image = the current job&#39;s image</li><li>jobRoleArn = the current job&#39;s role</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_definition.jl#LL23-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.register-Tuple{AbstractString}" href="#AWSBatch.register-Tuple{AbstractString}"><code>AWSBatch.register</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">register(
    definition_name::AbstractString;
    role::AbstractString=&quot;&quot;,
    image::AbstractString=&quot;&quot;,
    vcpus::Integer=1,
    memory::Integer=1024,
    cmd::Cmd=``,
    region::AbstractString=&quot;&quot;,
    parameters::Dict{String,String}=Dict{String, String}(),
) -&gt; JobDefinition</code></pre><p>Registers a new job definition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_definition.jl#LL82-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.deregister-Tuple{JobDefinition}" href="#AWSBatch.deregister-Tuple{JobDefinition}"><code>AWSBatch.deregister</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">deregister(job::JobDefinition)</code></pre><p>Deregisters an AWS Batch job.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_definition.jl#LL129-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.isregistered-Tuple{JobDefinition}" href="#AWSBatch.isregistered-Tuple{JobDefinition}"><code>AWSBatch.isregistered</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isregistered(definition::JobDefinition) -&gt; Bool</code></pre><p>Checks if a JobDefinition is registered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_definition.jl#LL140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.describe-Tuple{JobDefinition}" href="#AWSBatch.describe-Tuple{JobDefinition}"><code>AWSBatch.describe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">describe(definition::JobDefinition) -&gt; Dict</code></pre><p>Describes a job definition as a dictionary. Requires the IAM permissions &quot;batch:DescribeJobDefinitions&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_definition.jl#LL150-L155">source</a></section></article><h3 id="JobState"><a class="docs-heading-anchor" href="#JobState">JobState</a><a id="JobState-1"></a><a class="docs-heading-anchor-permalink" href="#JobState" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.JobState" href="#AWSBatch.JobState"><code>AWSBatch.JobState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">JobState</code></pre><p>An enum for representing different possible AWS Batch job states.</p><p>See <a href="http://docs.aws.amazon.com/batch/latest/userguide/job_states.html">docs</a> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/job_state.jl#LL2-L8">source</a></section></article><h3 id="LogEvent"><a class="docs-heading-anchor" href="#LogEvent">LogEvent</a><a id="LogEvent-1"></a><a class="docs-heading-anchor-permalink" href="#LogEvent" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AWSBatch.LogEvent" href="#AWSBatch.LogEvent"><code>AWSBatch.LogEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LogEvent</code></pre><p>A struct for representing an event in an AWS Batch job log.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaCloud/AWSBatch.jl/blob/1ec7feddad83a846f6a81b9c9a3e604cd64ff84c/src/log_event.jl#LL1-L5">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 9 March 2021 19:02">Tuesday 9 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
